Приложение 10. Особенности использования отдельных механизмов

Работа с HTML-документом

•

Элемент <TABLE> не может быть добавлен в качестве дочернего элемента в элемент <P>. Таким образом, конструкция <P><TABLE></TABLE></P> после обработки системой «1С:Предприятие» станет <P></P><TABLE></TABLE>. Правила обработки элемента <P> указаны в стандарте HTML (http://www.w3.org/TR/html401/struct/text.html), в разделе 9.3.1 Paragraphs: the P element.

Форма

•

Во время исполнения программного кода, находящегося в обработчике ожидания, не обрабатывается сочетание Ctrl + Break, а также не выполняется перерисовка экрана. Также не следует размещать в обработчике ожидания программный код, который будет препятствовать комфортной работе пользователя.

•

Оповещение сервера о закрытии формы (а также снятие блокировки с объекта, если он заблокирован) происходит в следующих случаях:

•

закрытие формы, если в форме для редактирования был заблокирован объект;

•

получение формы с сервера с помощью методов ОткрытьФорму(), ПолучитьФорму();

•

вызов серверных (контекстных и внеконтекстных) методов формы;

•

закрытие 20 форм;

•

система находится в состоянии ожидания более 20 секунд.

•

При выполнении следующих команд динамического списка:

•

удаление элемента;

•

пометка на удаление элемента;

•

проведение или отмена проведения документа;

•

перенос элемента справочника в другую группу.

•

При использовании метода ОткрытьЗначение() или при нажатии кнопки Открыть (лупа) поля ввода в случае, если прикладное решение выполняется в толстом клиенте, работающем в управляемом режиме, будет открыта форма списка при одновременном выполнении следующих условий:

•

Для объекта конфигурации выбран режим редактирования В списке (для справочников, планов обмена, планов видов характеристик, планов счетов, планов видов расчетов, независимых регистров сведений, бизнес-процессов и задач);

•

В прикладном решении существует обычная форма списка, выбранная в качестве основной или вспомогательной формы;

•

В прикладном решении разрешено использование обычных форм в управляемом приложении;

•

Отсутствует управляемая форма списка или объекта, выбранная в качестве основной или вспомогательной.

Работа с файлами

•

При работе с файлами в локальной файловой системе под ОС Windows следует помнить, что длина полного пути к файлу не может превышать 260 символов.

Табличный документ

выровнен по центру и выходит за границу ячейки, то при экспорте такого табличного документа в формат Microsoft Excel этот текст будет обрезан левой и правой границами ячейки. Чтобы избежать такого поведения, следует либо создать объединенную ячейку так, чтобы в ней помещался весь текст целиком, либо каждую строку многострочного текста размещать в своей строке табличного документа. При этом не рекомендуется делать отдельный формат для строки, содержащей ячейку с многострочным текстом.

•

Если у непустой ячейки табличного документа свойство РазмещениеТекста установлено в значение Авто, то ячейки объединяются до следующей заполненной ячейки либо до конца табличного документа по горизонтали.

•

Если в ячейке табличного документа находится текст, который по горизонтали выходит за границу ячейки, то при экспорте такого табличного документа в формат HTML, ячейки объединяются до следующей заполненной ячейки либо до конца табличного документа по горизонтали.

•

При экспорте табличного документа в формат PDF выполняется подбор шрифта для символов, отсутствующих в текущем шрифте табличного документа.

В клиентском приложении для ОС Windows используется шрифт Sans Serif. Для этого анализируется запись системного реестра HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontLink\SystemLink, в которой ищется запись для шрифта Microsoft Sans Serif. Если в указанном шрифте необходимые символы отсутствуют, то шрифт подбирается на основании диапазона символов UNICODE:

Диапазон символов Используемый шрифт

LATIN Microsoft Sans Serif

ARABIC Microsoft Sans Serif

HEBREW Microsoft Sans Serif

SYRIAC Estrangelo Edessa

THAANA MV Boli

GREEK Microsoft Sans Serif

CYRILLIC Microsoft Sans Serif

ARMENIAN Sylfaen

GEORGIAN Sylfaen

SINHALA Iskoola Pota

TIBETAN Microsoft Himalaya

PHAGS_PA Microsoft Phags Pa

THAI Microsoft Sans Serif

LAO DokChampa

DEVANAGARI Mangal

BENGALI Vrinda

GURMUKHI Raavi

GUJARATI Shruti

ORIYA Kalinga

TAMIL Latha

TELUGU Gautami

KANNADA Tunga

Диапазон символов Используемый шрифт

MALAYALAM Kartika

TAI_LE Microsoft Tai Le

NEW_TAI_LUE Microsoft New Tai Lue

KHMER DaunPenh

YI Microsoft Yi Baiti

ETHIOPIC Nyala

MONGOLIAN Mongolian Baiti

TIFINAGH Ebrima

NKO Ebrima

VAI Ebrima

CHEROKEE Plantagenet Cherokee

CANADIAN_ABORIGINAL Euphemia

OGHAM Segoe UI Symbol

RUNIC Segoe UI Symbol

BRAILLE Segoe UI Symbol

DESERET, Segoe UI Symbol

OSMANYA kEbrima

В клиентском приложении для ОС Linux, а также для веб-клиента, шрифт, удовлетворяющий требуемым характеристикам, подбирается из списка шрифтов, доступных в системе.

•

Экспорт табличного документа в форматы Microsoft Excel (Microsoft Excel 97, Microsoft Office OpenXML) и ODS (OpenDocument), имеет следующие ограничения при экспорте картинок, расположенных в ячейках табличного документа:

•

Если ячейка табличного документа содержит текст совместно с картинкой, и свойство Положение текста относительно картинки принимает значение Слева или Справа, то текст в остальных ячейках данной колонки будет обрезаться по размеру ячейки.

•

Если ячейка табличного документа содержит текст совместно с картинкой, и свойство Положение текста относительно картинки принимает значение Сверху или Снизу, то текст в остальных ячейках данной строки будет обрезаться по размеру ячейки.

•

Если свойство ячейки Положение текста относительно картинки принимает значение Слева или Справа и текст ячейки «заходит» на картинку в ячейке, то в результирующем документе для вывода текста поверх картинки используется рисунок типа «текст».

•

Если свойство ячейки Положение текста относительно картинки принимает значение Поверх, для вывода текста поверх картинки используется рисунок типа «текст», в этом случае для задания ориентации текста используется поворот рисунка типа «текст».

•

В ситуациях, когда текст горизонтально «забивается» картинкой (например, картинка выравнена влево, текст расположен слева от картинки) для текста не сохраняется ориентация.

•

При использовании в табличном документе нескольких форматов строк, разбиение по страницам выполняется по колонкам из первой строки табличного документа. Для этих колонок разбиение выполняется таким образом, чтобы колонка помещалась на страницу целиком. Колонки других форматов строк могут располагаться на странице не полностью.

•

При экспорте табличного документа в форматы Microsoft Excel (Microsoft Excel 97, Microsoft Office OpenXML), для ячеек, содержащих многострочный текст, выровненный по центру ячейки

расстояния, достаточные для размещения всего текста оригинальной ячейки. Колонки, в которые «попадают» левая и правая границы прямоугольника, занимаемого текстом, разбиваются на две.

В то же время, если ячейка табличного документа содержит многострочный текст, выровненный по центру и не умещающийся в ячейке, но при этом слева или справа от ячейки недостаточно места для того, чтобы полностью отобразить текст ячейки, то внешний вид таких ячеек в итоговом документе может не соответствовать виду этих же ячеек в табличном документе.

•

Если в табличном документе, который сохраняется в формате Microsoft Excel (Microsoft Excel 97, Microsoft Office OpenXML), длина текста, размещенного в ячейке табличного документа, превышает 32 767 символов, то сохранение такого табличного документа будет невозможно. Пользователю будет выведено сообщение об ошибке.

•

Особенности экспорта табличного документа, содержащего SVG:

•

При экспорте табличного документа в формат HTML, HTML4, документы формата Microsoft Office OpenXML, картинка преобразуется в точечное изображение с размером, зависящим от размеров в табличном документе, и сохраняется в формате PNG.

•

При экспорте в формат OpenDocument Spreadsheet, если картинка содержит фильтры, то изображение сохраняется аналогично формату Microsoft Office OpenXML, в противном случае изображение сохраняется в формате SVG.

•

При экспорте в HTML5 изображение в формате SVG вставляется непосредственно в документ.

•

При экспорте в PDF картинка в формате SVG экспортируется в векторном формате, используя возможности формата PDF. Элемент с фильтрами преобразуется в точечную картинку и сохраняется в таком виде. По умолчанию точечная картинка формируется для разрешения в 600 dpi. Экспорт больших картинок с фильтрами может занимать значительное время.

•

Особенности экспорта табличного документа, содержащего форматированные строки в колонтитулах:

•

При экспорте в формат Word

•

Игнорируются переводы строк.

•

Игнорируются картинки.

•

При экспорте в форматы Excel:

•

Игнорируются цвета текста и фона колонтитулов.

•

Суммарная длина всего (сумма всех трех колонтитулов табличного документа) колонтитула не должна превышать 255 символов, включая специальную информацию о формате текста (имен шрифтов, цвета и т. д.). Все, что превышает это ограничение ‑ будет обрезано.

•

Для формата XLS не экспортируются картинки.

•

Для формата XLSX экспортируется только первая картинка, заданная в колонтитуле, остальные картинки заменяются символом пробела.

•

При экспорте в формат Open Document Spreadsheet игнорируются изображения и цвет фона.

•

При экспорте табличного документа в форматы XLS (Microsoft Excel 97 ‑ 2003) и Microsoft Office OpenXML (Microsoft Excel 2007 и последующие версии) не выполняется экспорт имен областей исходного табличного документа.

Работа с почтой

•

При работе под управлением ОС Windows, отключение использования протокола OpenSSL при

редактирования системного реестра. Для этого ключ HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protoco следует установить в значение 0. Если ключ отсутствует, то его следует создать. Тип ключа ‑ DWORD.