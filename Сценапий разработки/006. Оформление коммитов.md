# 006. Оформление коммитов

**Создатель:** Lgovskiy Roman | Льговский Роман Николаевич, отредактировано июн 20, 2025

При помещении версий измененных объектов в хранилище конфигурации (далее - коммитов) в соответствующем диалоге конфигуратора необходимо заполнять поле "комментарий" (далее - сообщение коммита, либо сообщение).

В него заносится краткое описание характера изменений с точки зрения пользователя. Это действие в дальнейшем облегчит сборку общего описания изменений к релизу.

Формат сообщения коммита регламентирован и основан на стандарте Conventional Commits

## Структура сообщения коммитов:

```
<type>: <description>

[body]

[footer]
```

## `<type>`

Заголовок сообщения коммита указывает на специфику внесенных в кодовую базу изменений и завершается описанием (description)

Разрешено использование следующих типов

| Тип (type) | Описание |
|------------|----------|
| build | Сборка релиза, добавление новых библиотек, зависимостей |
| vbuild | Сборка релиза, добавление новых библиотек, зависимостей, предоставляемых поставщиком прикладного решения - фирмой 1С или другой компанией |
| ci | Работа с контуром CI |
| docs | Добавление, изменение документации |
| feat | Добавление нового функционала |
| fix | Исправление ошибок |
| perf | Изменение кода, повышающее производительность |
| refactor | Работа с техническим долгом. Рефакторинг. Правки кода без исправления ошибок или добавления новых функций |
| style | Работа с техническим долгом. Изменения, которые не влияют на смысл кода (пробелы, форматирование, пропущенные точки с запятой и т.д.) |
| revert | Откат на предыдущие версии |
| test | Добавление, исправление тестов |
| improvement | Развитие существующего функционала |
| adapt | Адаптация измененной или доработанной функциональности под новую конфигурацию поставщика. Только для обновляемых конфигураций, основанных на типовых (коробочных) продуктах |
| chore | Изменения, не влияющие на производственный код, например, первичное создание репозитория |

## `[description]`

Заголовок коммита, содержит краткое содержание изменений в результате выполнения задачи

Предмет задачи формируется от ожидаемого действия (отвечает на вопрос, Что сделать?):
- Доработать проведение документа "Установка таможенного режима"

Заголовок коммита формируется от результата выполненной задачи (отвечает на вопрос, Что сделано?):
- Доработано проведение документа "Установка таможенного режима"

## `[body]`

Структура тела коммита [body] зависит от его типа:

### feat:
- **Как было:**
  - Описать состояние системы до внесения изменений
- **Как стало:**
  - **Архитектура:**
    - Описать добавленные или измененные объекты метаданных,
    - Описать пользовательскую логику по работе с функционалом
  - **Результат:**
    - Взять список функциональных требований в задаче,
    - Описать результат по каждому требованию

На скрине ниже показан шаблон задачи в части раздела Требования, 04.23 Шаблон оформления задачи

![Шаблон задачи](screenshot_requirements.png)

Описать результат - это описать что было сделано

Например,
в задаче
**Как сделать**
- Добавить на форму документа поле "Период"
- Вывести значение поля "Период" в печатную форму "Заказ"

в коммите
- Добавлено на форму документа поле "Период"
- Поле выводится в шапку печатной формы "Заказ"

- **Пояснение:**
  - Добавить остальные важные факты

### fix:
- **Как было/ошибочное поведение:**
  - Описать причину ошибки
- **Как стало/исправление:**
  - Описать как исправлено

### vbuild:
- **Как было:**
  - Версия библиотеки (конфигурации поставщика до)
- **Как стало:**
  - Версия библиотеки (конфигурации поставщика после).
  - Краткое описание изменений/опционально

### build:
- **Как было:**
  - Версия релиза до
- **Как стало:**
  - Версия релиза после
  - Краткое описание изменений/опционально

### refactor, style:
- Описание сути рефакторинга. Что было переработано? Почему?
- Основание для рефакторинга (например Sonarqube [Номер правила])

### adapt:
- Описание причины из за которой потребовалась адаптация функционала. Что было изменено

При описании изменений - как стало - выписать список результатов по итогу выполнения задачи.

Для остальных типов форма тела произвольна и опциональна (необязательна)

**Примечание:**
- В теле сообщения коммита указать, что и почему было изменено
- Тело должно быть отделено от заголовка коммита одной пустой строкой

## `[footer]`

- Подвал сообщения коммита должен быть отделен от body одной пустой строкой
- Подвал содержит мета-информацию о коммите. Например, номер задачи (issue)
- Добавить по одной строке для каждой мета-информации

## Примеры:

### Jira#1
Доработать проведение документа Установка таможенного режима по послойному хранению

**Оформление коммита:**
```
feat: Доработано проведение документа "Установка таможенного режима"

Как было:
Движение по регистру накопления не выполнялось

Как стало/список результатов:
Доработана структура документа для проведения по регистру накопления гкс_ПослойноеХранение
Добавлено проведение по регистру

МЕТАДАННЫЕ: GMFM-2322
```

### Jira#2
Доработать Рабочее место специалиста ОТПР

**Оформление коммита:**
```
feat: Доработана обработка АРМ "Рабочее место специалиста ОТПР"

Как было:
Был быстрый отбор по виду перевозки

Как стало/список результатов:
Удален быстрый отбор по виду перевозки
Добавлено упорядочивание по колонке "Статус заявки РЖД"
Добавлено автоматическое заполнение реквизита "Срок выполнения" формы создания ГУ-12
Добавлено автоматическое заполнение реквизита "Организация" в создаваемой заявке РЖД

МЕТАДАННЫЕ: GMFM-2345
```

### Jira#3
Разработать контроль СДИЗ по схеме

**Оформление коммита:**
```
feat: Добавлен механизм контроля СДИЗ

Как стало:
Разработан механизм контроля правильности заполнения СДИЗ,
Доработаны формы для удобства просмотра результатов контроля

МЕТАДАННЫЕ: GMFM-2580
```

### Jira#5
Доработать процедуру заполнения тч "Дополнительно" документов ЖД накладная и Транспортная накладная

**Оформление коммита**
```
feat: Доработана процедура заполнения тч "Дополнительно" документов ЖД накладная и Транспортная накладная

Как стало:
Добавлен реквизит Таможенная процедура шапку документов ЖД накладная и Транспортная накладная. На форме он размещен прямо над табличной частью Декларации на товары.

При вызове команды Заполнить по сертификатам СОЭКС в командной панели таб.части Декларации на товары, программа будет проверять заполнение нового реквизита Таможенная процедура. Если реквизит не заполнен, тогда заполнение таб.части не будет выполнено.

Внесены доработки в процедуру заполнения табличной части Декларации на товары документов
При заполнении учитываются остатки только по той таможенной процедуре, которая указана в новом реквизите документа.

Добавлена возможность заполнения документа с учетом того, что остатки ГП ведутся в разрезе ГТД сырья.

Также это не изменение, но особенность алгоритма заполнения: если на остатках регистра Контроль по разрешениям на переработку (режим 51) будет недостаточно остатков, тогда количество груза в таб.части Декларации на товары будет меньше, чем в таб.части Вагоны.

Добавлена проверка при проведении документов ЖД накладная и Транспортная накладная добавлена проверка
Если в одной из строк табличной части Декларации на товары таможенная процедура не совпадает со значением нового реквизита Таможенная процедура, программа не даст выполнить проведение документа.

Доработан алгоритм формирования движений в регистре Контроль по разрешениям на переработку (режим 51). Как и раньше, поля аналитики: Сертификат СОЭКС, Номер ГТД (готовая продукция), Номенклатура - берутся из таб.части Декларации на товары. Разрешение на переработку и Таможенная процедура - из декларации на товары, по которой происходит отгрузка. Изменено использование аналитики Номер ГТД (сырье): если по таможенной процедуре ведется учет остатков ГП в разрезе ГТД сырья, тогда номера ГТД сырья будут подбираться по FIFO.

Доработан отчет, который вызывается по кнопке Сертификаты в шапке документов ЖД накладная и Транспортная накладная: в них добавлен новый блок: Отчет по сертификатам в разрезе ГТД. Этот блок показывает данные таб.части Декларации на товары. Таким образом можно визуально сравнить два блока: Отчет по сертификатам в разрезе вагонов и Отчет по сертификатам в разрезе ГТД.

МЕТАДАННЫЕ: ERPUPP12-3487
```

### Jira#6
Исправить проведение документа Изменение ШР

**Оформление коммита**
```
fix: Исправлено проведение документа Исправление ШР

Как было/Ошибочное поведение:
При изменении документа "Изменение штатного расписания" в момент проведения измененного документа возникает ошибка: Не удалось записать классы условий труда по должностям...

Как стало/Исправление:
Ошибка связана с тем, что в новом алгоритме записи данных классов условий труда по должностям не было предусмотрено, что в документе изменения ШР могут быть строки закрытия позиций ШР.

Для исправления этой ошибки я добавил проверку: изменения данных тех позиций ШР, которые уже закрыты - больше не будут отслеживаться. Соответственно запись данных в закрытые периоды осуществляться не будет.

МЕТАДАННЫЕ: HR30RU-1277
```

### Jira#4
Сформировать релиз MFM 2024.7.1.0

**Оформление коммита:**
```
build: Сформирован релиз MFM 2024.7.1.0

Как было:
Релиз 2024.6.1.0

Как стало:
Релиз 2024.7.1.0

МЕТАДАННЫЕ: GMFM-2455
```