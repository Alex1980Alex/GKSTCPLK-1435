#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда
	
#Область ПрограммныйИнтерфейс

// Функция - Получить показатель качества по коду ЛИМС
//
// Параметры:
//  Код	- Строка - код показателя ЛИМС
//  ТочкаМаршрута - СправочникСсылка.гкс_ТочкиМаршрута - Точка маршрута для которой определяется показатель
// 
// Возвращаемое значение:
//  СправочникСсылка.гкс_ПоказателиАнализовНоменклатуры - найденный показатель анализа номенклатуры или пустая ссылка
//
Функция ПолучитьПоказательКачестваПоКодуЛИМС(Код, ТочкаМаршрута) Экспорт
	
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр("КодЛИМС", Код);
	Запрос.УстановитьПараметр("ТочкаМаршрута", ТочкаМаршрута);

	Запрос.Текст = 
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	КодыПоказателейКачестваЛИМС.Показатель КАК Показатель
	|ИЗ
	|	РегистрСведений.гкс_КодыПоказателейКачестваЛИМС КАК КодыПоказателейКачестваЛИМС
	|ГДЕ
	|	КодыПоказателейКачестваЛИМС.ТочкаМаршрута = &ТочкаМаршрута
	|	И КодыПоказателейКачестваЛИМС.КодЛИМС = &КодЛИМС";
	
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Возврат Выборка.Показатель;	
	КонецЕсли;
	
	Возврат Справочники.гкс_ПоказателиАнализовНоменклатуры.ПустаяСсылка();

КонецФункции

#КонецОбласти

#КонецЕсли